<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Patterns of Enterprise Application Architecture - Concurrency</title>
  <meta name="author" content="Thiago Pontes" />
  <meta name="description" content="Programming, Javascript, Ruby, Ruby on Rails, Scala, Python" />
  <meta property="fb:admins" content="thiagopnts"/>
  <link rel="openid.server" href="http://www.clickpass.com/openid_server" />
  <link rel="stylesheet" href="/blog/css/compiled/base.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/blog/css/plugins/pygments.css" type="text/css" />
  <link media="only screen and (max-device-width: 480px)" href="/blog/css/iphone.css" type="text/css" rel="stylesheet" />
  <link media="only screen and (device-width: 768px)" href="/blog/css/ipad.css" type="text/css" rel="stylesheet" />
  <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="/blog/js/compiled/application.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      
    });
  </script>
</head>

<body>
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/pt_BR/all.js#xfbml=1&appId=254582621301698";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
    
  <section class="sidebar">
    <a href="/">
      <img src="http://www.gravatar.com/avatar/dfdcc7fdb4b631ae9c30acd5ac6c2cbe.png" height="75" width="75" class="avatar" />
    </a>

    <section class="name">
      <a href="/">
        <span id="thiago">Thiago</span>
        <span id="pontes">Pontes</span>
      </a>
    </section>

    <section class="alt-text">&nbsp;</section>

    <section class="meta">
      <a href="https://github.com/thiagopnts" id="github">
        <img src="/blog/images/github.png" alt="github" title="thiagopnts on GitHub" height="16" width="16" />
      </a>
      <a href="https://twitter.com/thiagopnts" id="twitter">
        <img src="/blog/images/twitter.png" alt="twitter" title="@thiagopnts on Twitter" height="16" width="16" />
      </a>
      <a href="http://feeds.feedburner.com/thiagopontes/lXRA" id="rss">
        <img src="/blog/images/rss.png" alt="rss" title="Subscribe to this blog's RSS feed" height="16" width="16" />
      </a>
      
    </section>

  </section>

  <section class="content">
  <h1>
    <a href="/posts/enterprise-patterns-part5">Patterns of Enterprise Application Architecture - Concurrency</a>
  </h1>

  <section class="byline">
    April 25, 2012
  </section>

  <p><img src="http://ecx.images-amazon.com/images/I/511D6FdsbXL._AA160_.jpg" width="250" height="250" /></p>

<h2>Chapter 5 &ndash; Concurrency</h2>

<p>This chapter talks about concurrency, one of most tricky parts of software development. It don&rsquo;t pretend to give a general treatment of concurrency(for that it could need at least a book), but it introduces concurrency issues for enterprise application development. Once its done with the brief introduction about concurrency, we will start to talk about the patterns for handling concurrency. All the problems here discussed can be imagined like the problems that a control version tool deal.</p>

<h2>Concurrency Problems</h2>

<p>The essential problems of concurrency are the problems that concurrency control systems try to prevent. The bigger problem here is that these system often create a new set of problems in their solutions. The First and simplest problem is called Lost updates. It happens, for instance, when someone is editing one file, then someone else starts to edit the same file and finish it before the first one, so the first one don&rsquo;t get the changes made by the other, and when he save his version will be write over the other version, updated early. The other problem is a inconsistent read. It occurs when you read two things that are correct pieces of information but not correct at the same time. For instance, if you read a value from A and then read a value from B to get a value C, if the A&rsquo;s value change while you are reading the B&rsquo;s value, your C value will be incorrect. Since the concurrency problems have been around for a while there are various solutions. For enterprise applications two solutions are particularly important: isolation and immutability. The problems accur when two active agents has access to the same data, one workaround here is data isolatio, partitioning the data so that any piece of it can only be accessed by one agent. This technique is used by operating systems to manage the memory used by processes. But what if we can&rsquo;t isolate all the mutable data? Then we have two approachs: optimistic and pessimistic concurrency control.</p>

<p>Using the optimistic locking Bob and Alice can edit the same file freely and the first one to finish can save it, and when the second one finish it&rsquo;s commit will be rejected and it comes to how wrote it to to figure out what to do to merge then. With the pessimistic locking whoever checks out the file first prevents anyone else from edit it. This approach can generate a deadlock since the other process who wants to access some locked resource can stay waiting forever and goes to starvation. A good way to think about it is that an optimistic lock is about conflict detection while a pessimistic lock is about conflict prevention.</p>

<h2>Other approachs for handling concurrency problems</h2>

<p>If your locking strategy requires that an object be loaded in order to be locked, such as in the optimist lock, locking a large group affects performance, and with the pessimistic lock a large lock set is a management headache and increases lock table contention. A Coarse-Grained Lock allows you to manage the concurrency of a group of objects together in a single lock without having to load all the members of the group in order to lock them. Other way is using the Implicit Lock, which saves the developer from having to manage locks directly, since one line that a developer forget to lock something can break the entire application, so you let the lock for your application framework.</p>


  <section class="meta">
    <h3>Discussion, links, and tweets</h3>
    <section class="copy">
      <a href="https://twitter.com/thiagopnts">
        <img src="http://www.gravatar.com/avatar/dfdcc7fdb4b631ae9c30acd5ac6c2cbe.png" height="80" width="80" />
      </a>

      <p>
          I'm a Software Engineer Intern which among one line of code and a cup of coffee likes to listen to music and disagree with people. </br>
          Feel free to send me a <a href="mailto:thiagopnts@gmail.com">email</a>. </br>
          I'm <a href="https://twitter.com/thiagopnts">@thiagopnts</a> on Twitter. </br>
          I'm <a href="http://git.io/thi">thiagopnts</a> on Github. </br>
          You can find me on <a href="http://facebook.com/thiagopnts">Facebook</a> and <a href="http://www.linkedin.com/profile/view?id=82767657">Linkedin</a>.
      </p>
      <a href="http://twitter.com/share" class="twitter-share-button" data-count="true" data-via="thiagopnts">Tweet</a>
      <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
      <a href="http://twitter.com/thiagopnts" class="twitter-follow-button" data-show-count="false">Follow @thiagopnts</a>
      <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
      <div class="fb-like" data-href="http://thiagopontes.net/posts/enterprise-patterns-part5" data-send="false" data-width="450" data-show-faces="true"></div>    
      <div class="fb-comments" data-href="http://thiagopontes.net/posts/enterprise-patterns-part5" data-num-posts="5" data-width="500"></div>    
    </section>
  </section>
</section>


    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-18026195-3']);
      _gaq.push(['_setDomainName', 'thiagopontes.net']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>

</html>
