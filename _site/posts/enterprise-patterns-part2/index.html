<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Patterns of Enterprise Application Architecture - Organizing Domain Logic</title>
  <meta name="author" content="Thiago Pontes" />
  <meta name="description" content="Programming, Javascript, Ruby, Ruby on Rails, Scala, Python" />
  <meta property="fb:admins" content="thiagopnts"/>
  <link rel="openid.server" href="http://www.clickpass.com/openid_server" />
  <link rel="stylesheet" href="/css/compiled/base.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/plugins/pygments.css" type="text/css" />
  <link media="only screen and (max-device-width: 480px)" href="/css/iphone.css" type="text/css" rel="stylesheet" />
  <link media="only screen and (device-width: 768px)" href="/css/ipad.css" type="text/css" rel="stylesheet" />
  <link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css'>
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="/js/compiled/application.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      
    });
  </script>
</head>

<body>
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/pt_BR/all.js#xfbml=1&appId=254582621301698";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>
    
  <section class="sidebar">
    <a href="/">
      <img src="http://www.gravatar.com/avatar/dfdcc7fdb4b631ae9c30acd5ac6c2cbe.png" height="75" width="75" class="avatar" />
    </a>

    <section class="name">
      <a href="/">
        <span id="thiago">Thiago</span>
        <span id="pontes">Pontes</span>
      </a>
    </section>

    <section class="alt-text">&nbsp;</section>

    <section class="meta">
      <a href="https://github.com/thiagopnts" id="github">
        <img src="/images/github.png" alt="github" title="thiagopnts on GitHub" height="16" width="16" />
      </a>
      <a href="https://twitter.com/thiagopnts" id="twitter">
        <img src="/images/twitter.png" alt="twitter" title="@thiagopnts on Twitter" height="16" width="16" />
      </a>
      <a href="http://feeds.feedburner.com/thiagopontes/lXRA" id="rss">
        <img src="/images/rss.png" alt="rss" title="Subscribe to this blog's RSS feed" height="16" width="16" />
      </a>
      
    </section>

  </section>

  <section class="content">
  <h1>
    <a href="/posts/enterprise-patterns-part2">Patterns of Enterprise Application Architecture - Organizing Domain Logic</a>
  </h1>

  <section class="byline">
    April  4, 2012
  </section>

  <p><img src="http://ecx.images-amazon.com/images/I/511D6FdsbXL._AA160_.jpg" width="250" height="250" /></p>

<h2>Chapter 2 &ndash; Organizing Domain Logic</h2>

<p>This chapter describe several ways for how to organize the domain logic and it relies into three primary patterns: Transaction Script, Domain Model and Table Module. Describing each approach and its biggest advantages and disadvantages, and showing how it interacts using other patterns like Gateway, RecordSet and Data Mapper.</p>

<h2>Transaction Script Pattern</h2>

<p>The simplest approach to organize domain logic is using the Transaction Script, this pattern is essentially a procedure that takes the input from the presentation, processes it with validations and stores in the database. It then replies with data to the presentation layer. The fundamental organization is of a single procedure for each action that a user might want to do. You can use classes instead of procedures to use this pattern in an object-oriented fashion. The most common is to have several Transaction Scripts in a single class, where each method defines a subject area of related Transational Scripts. To identify the TSs you can think as each database transaction can be turned into a TS. The biggest advantage is its simplicity, organizing logic this way is good for applications with only a small amount of logic, this helps keeping the code clean and understandable, but increasing the complexity a amount of logic it keeps hard to keep it in a well-designed state, other problem to beware is the code duplication that could happen since the transaction seems to be fairly similar. When the domain logic gets more complex its time to use the Domain Model pattern.</p>

<h2>Domain Logic Pattern</h2>

<p>This pattern has an OO style(which can be implemented as an Entity Bean in J2EE apps), it divides the logic into objects, in the simplest form, it looks like one object for each database table. A rich Domain Model can look different from the database design, with inheritance, strategies and other patterns, this approach is better for a more complex logic but its more harder to map to the database. A good ideia is to use a simple domain model with the Active Record pattern and the Data Mapper pattern for the complex ones. Since the bussiness logic can change, it&rsquo;s importante to be able to modify, build, and test this layer easily, so you&rsquo;ll want the minimum of coupling from the domain to other layers. A common concern is about overloading a domain object, you&rsquo;ll notice that some behavior is similar to every model and it could be good to isolate it in other object. The problem is that it creates code hard to maintain, and the other developers tend to not see it in the model and duplicate the code, and the duplication can quickly lead to complexity and inconsistency. So, the advice here is to only fix the bloating in the models when, and if, it becomes a problem.</p>

<h2>Table Module Pattern</h2>

<p>One of the problems with the Domain Model pattern is the interface with relational databases, as a result is needed a lot of work to pull data in and out of the database as the complex of domain logic grows. The Table Module pattern organizes domain logic with one class per table and a single instance of a class contains the various methods to act on data. The main difference is that if with you have various objects using the Domain Logic pattern each one is responsible for itself, while using the table module, you will have to deal just if one instance to do the work for all the objects, it acts like a facade where you can do the CRUD and the object is unaware of the operations. This pattern gives you an interface that acts on the passed data. This pattern can be an instance with a collection of static methods, you can then use this instance to manipulate the data. The word table in the pattern name suggests that you have one Table Module per table in the database, while this is true in some cases it isn&rsquo;t recommended because the structure of the Table Module doesn&rsquo;t depends on the structure of the tables in the database but more on the virtual tables perceived by the applications, usually represented with some data structure resulted from some other query.</p>

<h1>Conclusion</h1>

<p>As all things in software architecture you can choose what to use and how to use it to solve your problem, you can even use these three patterns combined if you need, as the author says, a good solution is implement the Domain Logic using Transaction Scripts on it. So it&rsquo;s up to you to decide the best approach to solve your problem. Next week I will talk about the Chapter 3.</p>


  <section class="meta">
    <h3>Discussion, links, and tweets</h3>
    <section class="copy">
      <a href="https://twitter.com/thiagopnts">
        <img src="http://www.gravatar.com/avatar/dfdcc7fdb4b631ae9c30acd5ac6c2cbe.png" height="80" width="80" />
      </a>

      <p>
          I'm a Software Engineer Intern which among one line of code and a cup of coffee likes to listen to music and disagree with people. </br>
          Feel free to send me a <a href="mailto:thiagopnts@gmail.com">email</a>. </br>
          I'm <a href="https://twitter.com/thiagopnts">@thiagopnts</a> on Twitter. </br>
          I'm <a href="http://git.io/thi">thiagopnts</a> on Github. </br>
          You can find me on <a href="http://facebook.com/thiagopnts">Facebook</a> and <a href="http://www.linkedin.com/profile/view?id=82767657">Linkedin</a>.
      </p>
      <a href="http://twitter.com/share" class="twitter-share-button" data-count="true" data-via="thiagopnts">Tweet</a>
      <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
      <a href="http://twitter.com/thiagopnts" class="twitter-follow-button" data-show-count="false">Follow @thiagopnts</a>
      <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
      <div class="fb-like" data-href="http://thiagopontes.net/posts/enterprise-patterns-part2" data-send="false" data-width="450" data-show-faces="true"></div>    
      <div class="fb-comments" data-href="http://thiagopontes.net/posts/enterprise-patterns-part2" data-num-posts="5" data-width="500"></div>    
    </section>
  </section>
</section>


    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-18026195-3']);
      _gaq.push(['_setDomainName', 'thiagopontes.net']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>

</html>
